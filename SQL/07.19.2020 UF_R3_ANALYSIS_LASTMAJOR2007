# Count the number of major for each student
CREATE TABLE UF_R3_ANALYSIS_MAJORCOUNT2007 AS(
select 
A.PERSON_SID,
count(A.ACAD_PROG_PRIMARY) AS MAJORCOUNT
from UFDL_PWCBA_DATA.uf_r3_analysis_date2007 A
GROUP BY person_sid

)

#Create the final table
CREATE TABLE UF_R3_ANALYSIS_LASTMAJOR0714 AS(
select 
A.PERSON_SID,
A.TERM_SID,
A.AGE_YEARS,
A.AGE_MONTHS,
A.AGE_DAYS,
A.JUNIOR_SENIOR_FLAGNO,
A.TOT_TRNSFR,
A.TOT_TEST_CREDIT,
A.UNT_TAKEN_PRGRSS,
A.CUM_GPA,
A.ENRL_CNT,
A.ACAD_PROG_PRIMARY,
B.MAJORCOUNT,
A.TERM_BEG_DT_SID,
A.UF_CLASSNO,
A.RESIDENCYNO,
A.TOT_TAKEN_GPA,
A.ACAD_PROG_PRIMARYNO,
A.UF_CLASS_EOTNO,
A.UNT_TAKEN_GPA,
A.TERM_END_DT_SID_CATGRYNO,
A.TERM_BEG_DT_CATGRYNO,
A.STUDENT_SUCCESSNO,
A.LOW_TERM_GPA_IND,
A.PARTTIME_TERM_IND,
A.NOT_REG_TERM_IND,
A.WITHDRWL_TERM_IND,
A.FULLTIME_TERM_IND,
A.OVR_12HR_TERM_IND
FROM UFDL_PWCBA_DATA.uf_r3_analysis_majorcount2007 B INNER JOIN UFDL_PWCBA_DATA.uf_r3_analysis_maxsuccess2007 A
ON A.PERSON_SID = B.PERSON_SID
WHERE A.TERM_BEG_DT_SID<20150000
)
