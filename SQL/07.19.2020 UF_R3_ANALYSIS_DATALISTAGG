#Create this table to combine all the information of each in one row.

CREATE TABLE UF_R3_ANALYSIS_DATALISTAGG AS(
SELECT
PERSON_SID,
LISTAGG(TERM_SID,',') WITHIN GROUP( ORDER BY TERM_BEG_DT_SID)AS TERM_SID,
LISTAGG(AGE_YEARS,',') WITHIN GROUP( ORDER BY TERM_BEG_DT_SID)AS AGE_YEARS ,
LISTAGG(AGE_MONTHS,',') WITHIN GROUP( ORDER BY TERM_BEG_DT_SID) AS AGE_MONTHS,
LISTAGG(AGE_DAYS,',') WITHIN GROUP( ORDER BY TERM_BEG_DT_SID) AS AGE_DAYS,
LISTAGG(JUNIOR_SENIOR_FLAGNO,',') WITHIN GROUP( ORDER BY TERM_BEG_DT_SID) AS JUNIOR_SENIOR_FLAGNO,
LISTAGG(TOT_TRNSFR,',') WITHIN GROUP( ORDER BY TERM_BEG_DT_SID)AS TOT_TRNSFR,
LISTAGG(TOT_TEST_CREDIT,',') WITHIN GROUP( ORDER BY TERM_BEG_DT_SID)AS TOT_TEST_CREDIT,
LISTAGG(UNT_TAKEN_PRGRSS,',') WITHIN GROUP( ORDER BY TERM_BEG_DT_SID)AS UNT_TAKEN_PRGRSS,
LISTAGG(CUM_GPA,',') WITHIN GROUP( ORDER BY TERM_BEG_DT_SID) AS CUM_GPA,
LISTAGG(ENRL_CNT,',') WITHIN GROUP( ORDER BY TERM_BEG_DT_SID)AS ENRL_CNT,
LISTAGG(ACAD_PROG_PRIMARY,',') WITHIN GROUP( ORDER BY TERM_BEG_DT_SID) AS ACAD_PROG_PRIMARY,
LISTAGG(TERM_BEG_DT_SID,',') WITHIN GROUP( ORDER BY TERM_BEG_DT_SID) AS TERM_BEG_DT_SID,
LISTAGG(UF_CLASSNO,',') WITHIN GROUP( ORDER BY TERM_BEG_DT_SID) AS UF_CLASSNO,
LISTAGG(RESIDENCYNO,',') WITHIN GROUP( ORDER BY TERM_BEG_DT_SID) AS RESIDENCYNO,
LISTAGG(TOT_TAKEN_GPA,',') WITHIN GROUP( ORDER BY TERM_BEG_DT_SID) AS TOT_TAKEN_GPA,
LISTAGG(ACAD_PROG_PRIMARYNO,',') WITHIN GROUP( ORDER BY TERM_BEG_DT_SID) AS ACAD_PROG_PRIMARYNO,
LISTAGG(UF_CLASS_EOTNO,',') WITHIN GROUP( ORDER BY TERM_BEG_DT_SID) AS UF_CLASS_EOTNO,
LISTAGG(UNT_TAKEN_GPA,',') WITHIN GROUP( ORDER BY TERM_BEG_DT_SID) AS UNT_TAKEN_GPA,
LISTAGG(TERM_END_DT_SID_CATGRYNO,',') WITHIN GROUP( ORDER BY TERM_BEG_DT_SID) AS TERM_END_DT_SID_CATGRYNO,
LISTAGG(TERM_BEG_DT_CATGRYNO,',') WITHIN GROUP( ORDER BY TERM_BEG_DT_SID) AS TERM_BEG_DT_CATGRYNO,
LISTAGG(STUDENT_SUCCESSNO,',') WITHIN GROUP( ORDER BY TERM_BEG_DT_SID) AS STUDENT_SUCCESSNO,
LISTAGG(LOW_TERM_GPA_IND,',') WITHIN GROUP( ORDER BY TERM_BEG_DT_SID) AS LOW_TERM_GPA_IND,
LISTAGG(PARTTIME_TERM_IND,',') WITHIN GROUP( ORDER BY TERM_BEG_DT_SID) AS PARTTIME_TERM_IND,
LISTAGG(NOT_REG_TERM_IND,',') WITHIN GROUP( ORDER BY TERM_BEG_DT_SID) AS NOT_REG_TERM_IND,
LISTAGG(WITHDRWL_TERM_IND,',') WITHIN GROUP( ORDER BY TERM_BEG_DT_SID) AS WITHDRWL_TERM_IND,
LISTAGG(FULLTIME_TERM_IND,',') WITHIN GROUP( ORDER BY TERM_BEG_DT_SID) AS FULLTIME_TERM_IND,
LISTAGG(OVR_12HR_TERM_IND,',') WITHIN GROUP( ORDER BY TERM_BEG_DT_SID) AS OVR_12HR_TERM_IND

from UF_R3_ANALYSIS_DATE2007V2
GROUP BY PERSON_SID
)
